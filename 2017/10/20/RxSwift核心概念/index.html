<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Levin Luo">
    
    <meta name="description" content="Stay hungryã€stay foolish.">
    
    
    
    
    
    
    <title>RxSwiftæ ¸å¿ƒæ¦‚å¿µ | One Piece</title>
    <link href=â€http://yoursite.comâ€œ rel=â€prefetchâ€ />

    <link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/aos.css">
<link rel="stylesheet" href="/css/style.css">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/aos.js"></script>
    <script src="/js/highslide/highslide-full.min.js"></script>
    <link rel="stylesheet" href="/js/highslide/highslide.css">
    <style type="text/css">
        @media (max-width: 768px) {
            body {
                background-color: #f0f0f0;
                background: url('/imgs/xsbg.gif');
                background-attachment: fixed;
            }
        }
    </style>
    
    <!--<script type="text/javascript">
      if (document.images) {
        var avatar = new Image();
        avatar.src = '/imgs/avatar.jpg'
        var previews = 'preview1.jpg,preview2.jpg,preview3.jpg,preview4.jpg'.split(',')
        var previewsPreLoad = []
        for(var i = 0; i < length; i++) {
          previewsPreLoad.push(new Image())
          previewsPreLoad[previewsPreLoad.length - 1].src = '/imgs/preview' + previews[i]
        }
      }
    </script>-->
</head>
<body>
    <!-- èƒŒæ™¯è½®æ’­å›¾åŠŸèƒ½ -->
    <section class="hidden-xs">
    <ul class="cb-slideshow">
        <li><span>å¤©è‹¥</span></li>
        <li><span>æœ‰æƒ…</span></li>
        <li><span>å¤©äº¦è€</span></li>
        <li><span>æˆ‘ä¸º</span></li>
        <li><span>é•¿è€…</span></li>
        <li><span>ç»­ä¸€ç§’</span></li>
    </ul>
</section>
    <!-- æ¬§å°¼é…±åŠŸèƒ½, è°ç”¨è°çŸ¥é“ -->
    
    <header class="navbar navbar-inverse" id="gal-header">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target=".bs-navbar-collapse"
                    aria-expanded="false">
                <span class="fa fa-lg fa-reorder"></span>
            </button>
            <a href="http://yoursite.com">
                
                <style>
                    #gal-header .navbar-brand {
                        height: 54px;
                        line-height: 24px;
                        font-size: 28px;
                        opacity: 1;
                        background-color: rgba(0,0,0,0);
                        text-shadow: 0 0 5px #fff,0 0 10px #fff,0 0 15px #fff,0 0 20px #228DFF,0 0 35px #228DFF,0 0 40px #228DFF,0 0 50px #228DFF,0 0 75px #228DFF;
                    }
                </style>
                <!-- è¿™é‡Œä½¿ç”¨æ–‡å­—(navbar_text or config.title) -->
                <div class="navbar-brand">One Piece</div>
                
            </a>
        </div>
        <div class="collapse navbar-collapse bs-navbar-collapse">
            <ul class="nav navbar-nav" id="menu-gal">
                
                
                <li class="">
                    <a href="/">
                        <i class="fa fa-home"></i>é¦–é¡µ
                    </a>
                </li>
                
                
                
                <li class="">
                    <a href="/archives">
                        <i class="fa fa-archive"></i>å½’æ¡£
                    </a>
                </li>
                
                
                
                
                <li class="">
                    <a href="/categories">
                        <i class="fa fa-list"></i>åˆ†ç±»
                    </a>
                </li>
                
                
                
                
                
                <li class="dropdown">
                    <!-- TODO æ·»åŠ hover dropdownæ•ˆæœ -->
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false" data-hover="dropdown">
                        <i class="fa fa-tags"></i>æ ‡ç­¾
                    </a>
                    <ul class="dropdown-menu">
                        
                        
                        <li>
                            <a href="/tags/RxSWift/">RxSWift</a>
                        </li>
                        
                        <li>
                            <a href="/tags/RxSwift/">RxSwift</a>
                        </li>
                        
                        <li>
                            <a href="/tags/UIç¯‡/">UIç¯‡</a>
                        </li>
                        
                        
                        <li>
                            <a href="/tags">...</a>
                        </li>
                        
                        
                    </ul>
                </li>
                
                
                
                
                <li class="">
                    <a href="/about">
                        <i class="fa fa-user"></i>å…³äºæˆ‘
                    </a>
                </li>
                
                
            </ul>
        </div>
    </div>
</header>
    <div id="gal-body">
        <div class="container">
            <div class="row">
                <div class="col-md-8 gal-right" id="mainstay">
                    
<article class="article well article-body" id="article">
    <div class="breadcrumb">
        <i class="fa fa-home"></i>
        <a href="http://yoursite.com">One Piece</a>
        >
        <span>RxSwiftæ ¸å¿ƒæ¦‚å¿µ</span>
    </div>
    <!-- å¤§å‹è®¾å¤‡è¯¦ç»†æ–‡ç«  -->
    <div class="hidden-xs">
        <div class="title-article">
            <h1>
                <a href="/2017/10/20/RxSwiftæ ¸å¿ƒæ¦‚å¿µ/">RxSwiftæ ¸å¿ƒæ¦‚å¿µ</a>
            </h1>
        </div>
        <div class="tag-article">
            
            <span class="label label-gal">
                <i class="fa fa-tags"></i>
                
                <a href="/tags/RxSwift/">RxSwift</a>
                
            </span>
            
            <span class="label label-gal">
                <i class="fa fa-calendar"></i> 2017-10-20
            </span>
            
        </div>
    </div>
    <!-- å°å‹è®¾å¤‡è¯¦ç»†æ–‡ç«  -->
    <div class="visible-xs">
        <center>
            <div class="title-article">
                <h4>
                    <a href="/2017/10/20/RxSwiftæ ¸å¿ƒæ¦‚å¿µ/">RxSwiftæ ¸å¿ƒæ¦‚å¿µ</a>
                </h4>
            </div>
            <p>
                <i class="fa fa-calendar"></i> 2017-10-20
            </p>
            <p>
                
                <i class="fa fa-tags"></i>
                
                <a href="/tags/RxSwift/">RxSwift</a>
                
                
                
            </p>
        </center>
    </div>
    <div class="content-article">
        <p><a href="https://github.com/ReactiveX/RxSwift" target="_blank" rel="noopener">RxSwift</a>æ˜¯Swiftå‡½æ•°å“åº”å¼ç¼–ç¨‹çš„ä¸€ä¸ªå¼€æºåº“ï¼Œç”±Githubçš„ReactiveXç»„ç»‡å¼€å‘ï¼Œç»´æŠ¤ã€‚<br><br>RxSwiftçš„ä½œç”¨æ˜¯è®©è®©æ•°æ®/äº‹ä»¶æµå’Œå¼‚æ­¥ä»»åŠ¡èƒ½å¤Ÿæ›´æ–¹ä¾¿çš„åºåˆ—åŒ–å¤„ç†ï¼Œèƒ½å¤Ÿä½¿ç”¨Swiftè¿›è¡Œå“åº”å¼ç¼–ç¨‹.</p>
<h1 id="é“¾å¼ç¼–ç¨‹"><a href="#é“¾å¼ç¼–ç¨‹" class="headerlink" title="é“¾å¼ç¼–ç¨‹"></a>é“¾å¼ç¼–ç¨‹</h1><p>é€šè¿‡é«˜é˜¶å‡½æ•°ä»¥ç‚¹ä¸ºè¿æ¥å°†å¤šä¸ªå‡½æ•°è¿æ¥åœ¨ä¸€èµ·å®Œæˆå‚æ•°ä¼ é€’å’Œå¤æ‚çš„æ“ä½œ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">enum MyError: Error &#123;</span><br><span class="line">    case DivZero // é™¤æ•°ä¸º0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Calculate: NSObject &#123;</span><br><span class="line">    </span><br><span class="line">    class func ts_calculate(make: (Calculate) -&gt; Void) &#123;</span><br><span class="line">        let calculate = Calculate()</span><br><span class="line">        make(calculate)</span><br><span class="line">        print(calculate.result)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //ä¿å­˜è®¡ç®—ç»“æœ</span><br><span class="line">    var result: Float = 0.0</span><br><span class="line"></span><br><span class="line">    //åŠ </span><br><span class="line">    func add(num: Float) -&gt; Calculate &#123;</span><br><span class="line">            result += num</span><br><span class="line">            return self</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //å‡</span><br><span class="line">    func sub(num: Float) -&gt; Calculate &#123;</span><br><span class="line">        result -= num</span><br><span class="line">        return self</span><br><span class="line">    &#125;</span><br><span class="line">    //ä¹˜</span><br><span class="line">    func mul(num: Float) -&gt; Calculate &#123;</span><br><span class="line">        result *= num</span><br><span class="line">        return self</span><br><span class="line">    &#125;</span><br><span class="line">    //é™¤</span><br><span class="line">    func div(num: Float) throws -&gt; Calculate &#123;</span><br><span class="line">        guard num != 0 else&#123;</span><br><span class="line">            throw MyError.DivZero</span><br><span class="line">        &#125;</span><br><span class="line">        result /= num</span><br><span class="line">        return self</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ä½¿ç”¨</span><br><span class="line"> Calculate.ts_calculate &#123; (make) in</span><br><span class="line">            </span><br><span class="line">            make.add(num: 6).sub(num: 2).mul(num: 5)</span><br><span class="line">            </span><br><span class="line">            do &#123;</span><br><span class="line">                try make.div(num: 0)</span><br><span class="line">            &#125;catch &#123;</span><br><span class="line">                print(error)</span><br><span class="line">            &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h1 id="å“åº”å¼ç¼–ç¨‹"><a href="#å“åº”å¼ç¼–ç¨‹" class="headerlink" title="å“åº”å¼ç¼–ç¨‹"></a>å“åº”å¼ç¼–ç¨‹</h1><p>å“åº”å¼ç¼–ç¨‹æ ¹æºäº FRPï¼ˆå‡½æ•°å“åº”å¼ç¼–ç¨‹ï¼‰å‘½ä»¤é©±åŠ¨çš„ç¼–ç¨‹æ–¹å¼ï¼Œæ˜¯ä»¥å¼‚æ­¥æ•°æ®æµçš„å½¢å¼è¿›è¡Œç¼–ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var B = 20</span><br><span class="line">let C = A * 2 + B</span><br><span class="line">// å½“å‰å€¼</span><br><span class="line">// A = 10, B = 20, C = 40</span><br><span class="line">A = 0</span><br><span class="line">// å½“å‰å€¼</span><br><span class="line">// A = 0, B = 20, C = 40</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡ŒæŠŠa,b,cå½“æˆæŸä¸ªçŠ¶æ€ï¼Œcæ˜¯a,bä¸¤ä¸ªçŠ¶æ€çš„ç»„åˆï¼Œæ­£å¸¸çš„ç¼–ç¨‹ä¸­ï¼Œåœ¨è®¡ç®—äº†cçš„çŠ¶æ€ä¹‹åï¼Œå†å»æ”¹å˜a,bçš„çŠ¶æ€æ˜¯ä¸ä¼šå½±å“åˆ°cçš„çŠ¶æ€çš„ã€‚æ‰€ä»¥åœ¨æ­£å¸¸ç¼–ç¨‹ä¸­æˆ‘ä»¬è¦å»è®°å½•å¾ˆå¤šçŠ¶æ€å¹¶åŠæ—¶æ›´æ–°çŠ¶æ€ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚çš„çŠ¶æ€ï¼Œä¸‹æ‹‰åˆ·æ–°çš„çŠ¶æ€ã€‚å„ç§å„æ ·çš„äº‹ä»¶å“åº”æ–¹å¼ï¼Œæ— å½¢ä¸­å¢åŠ äº†ç¼–ç çš„å¤æ‚åº¦ã€‚è€Œåœ¨å“åº”å¼ç¼–ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€çš„æ”¹å˜éƒ½ä¼šå‘å‡ºä¸€ä¸ªä¿¡å·ï¼Œæ›´æ–°ä¸ä¹‹å…³è”çš„çŠ¶æ€ã€‚</p>
<p>ä¸€èˆ¬å¯ä½¿ç”¨å¼¹ç å›¾æ¥å±•ç¤ºè¿™ä¸ªåŸç†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºè¿ç»­çš„ä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸€ä¸ªå¼¹ç è¡¨ç¤ºå‘ç”Ÿåœ¨ç‰¹å®šæ—¶åˆ»çš„ä¸€ä¸ªäº‹ä»¶ã€‚<br><img src="http://ww1.sinaimg.cn/mw690/005YMFkugy1fqy3ja9xt5j30id05k0ss.jpg" alt=""></p>
<h1 id="Observable-å¯è¢«ç›‘å¬çš„åºåˆ—"><a href="#Observable-å¯è¢«ç›‘å¬çš„åºåˆ—" class="headerlink" title="Observable - å¯è¢«ç›‘å¬çš„åºåˆ—"></a>Observable - å¯è¢«ç›‘å¬çš„åºåˆ—</h1><p>Observableä¹Ÿå°±æ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿçš„å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªäº‹ä»¶åºåˆ—ï¼Œè®¢é˜…è€…å¯ä»¥è®¢é˜…å®ƒï¼Œç›‘æµ‹äº‹ä»¶çš„å‘ç”Ÿ(Next\Complete\Error)</p>
<ul>
<li>.onNext(element) è¡¨ç¤ºæ–°çš„äº‹ä»¶æ•°æ®ã€‚</li>
<li>.onError(error) è¡¨ç¤ºäº‹ä»¶åºåˆ—å› å¼‚å¸¸è€Œå®Œç»“ã€‚</li>
<li>.onCompleted() è¡¨ç¤ºäº‹ä»¶åºåˆ—å®Œç»“ã€‚</li>
</ul>
<h2 id="åˆ›å»ºåºåˆ—"><a href="#åˆ›å»ºåºåˆ—" class="headerlink" title="åˆ›å»ºåºåˆ—"></a>åˆ›å»ºåºåˆ—</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">let numbers: Observable&lt;Int&gt; = Observable.create &#123; observer -&gt; Disposable in</span><br><span class="line"></span><br><span class="line">    observer.onNext(0)</span><br><span class="line">    observer.onNext(1)</span><br><span class="line">    observer.onNext(2)</span><br><span class="line">    observer.onNext(3)</span><br><span class="line">    observer.onNext(4)</span><br><span class="line">    observer.onNext(5)</span><br><span class="line">    observer.onNext(6)</span><br><span class="line">    observer.onNext(7)</span><br><span class="line">    observer.onNext(8)</span><br><span class="line">    observer.onNext(9)</span><br><span class="line">    observer.onCompleted()</span><br><span class="line"></span><br><span class="line">    return Disposables.create()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">numbers</span><br><span class="line">    .subscribe(onNext: &#123; num in</span><br><span class="line">        print(&quot;å–å¾— num æˆåŠŸ: \(num)&quot;)</span><br><span class="line">    &#125;, onError: &#123; error in</span><br><span class="line">        print(&quot;å–å¾— num å¤±è´¥ Error: \(error.localizedDescription)&quot;)</span><br><span class="line">    &#125;, onCompleted: &#123;</span><br><span class="line">        print(&quot;å–å¾— num ä»»åŠ¡æˆåŠŸå®Œæˆ&quot;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/mw690/005YMFkugy1fqybs8xawxj30jy029dft.jpg" alt=""></p>
<h3 id="ç‰¹å¾åºåˆ—"><a href="#ç‰¹å¾åºåˆ—" class="headerlink" title="ç‰¹å¾åºåˆ—"></a>ç‰¹å¾åºåˆ—</h3><p>RxSwift é‡Œé¢ Observable ä¹Ÿå­˜åœ¨ä¸€äº›ç‰¹å¾åºåˆ—ï¼Œè¿™äº›ç‰¹å¾åºåˆ—å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å‡†ç¡®çš„æè¿°åºåˆ—ã€‚å¹¶ä¸”å®ƒä»¬è¿˜å¯ä»¥ç»™æˆ‘ä»¬æä¾›è¯­æ³•ç³–ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿç”¨æ›´åŠ ä¼˜é›…çš„æ–¹å¼ä¹¦å†™ä»£ç </p>
<h4 id="Single"><a href="#Single" class="headerlink" title="Single"></a>Single</h4><p>Single æ˜¯ Observable çš„å¦å¤–ä¸€ä¸ªç‰ˆæœ¬ã€‚ä¸åƒ Observable å¯ä»¥å‘å‡ºå¤šä¸ªå…ƒç´ ï¼Œå®ƒè¦ä¹ˆåªèƒ½å‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œè¦ä¹ˆäº§ç”Ÿä¸€ä¸ª error äº‹ä»¶ã€‚</p>
<p>ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ä¾‹å­å°±æ˜¯æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œç„¶åè¿”å›ä¸€ä¸ªåº”ç­”æˆ–é”™è¯¯ã€‚ä¸è¿‡ä½ ä¹Ÿå¯ä»¥ç”¨ Single æ¥æè¿°ä»»ä½•åªæœ‰ä¸€ä¸ªå…ƒç´ çš„åºåˆ—,ä¸å…±äº«çŠ¶æ€å˜åŒ–.ä¹Ÿå¯ä»¥å¯¹ Observable è°ƒç”¨ .asSingle() æ–¹æ³•ï¼Œå°†å®ƒè½¬æ¢ä¸º Single</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">func getRepo(_ repo: String) -&gt; Single&lt;[String: Any]&gt; &#123;</span><br><span class="line"></span><br><span class="line">    return Single&lt;[String: Any]&gt;.create &#123; single in</span><br><span class="line">        let url = URL(string: &quot;https://api.github.com/repos/\(repo)&quot;)!</span><br><span class="line">        let task = URLSession.shared.dataTask(with: url) &#123;</span><br><span class="line">            data, _, error in</span><br><span class="line"></span><br><span class="line">            if let error = error &#123;</span><br><span class="line">                single(.error(error))</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            guard let data = data,</span><br><span class="line">                  let json = try? JSONSerialization.jsonObject(with: data, options: .mutableLeaves),</span><br><span class="line">                  let result = json as? [String: Any] else &#123;</span><br><span class="line">                single(.error(DataError.cantParseJSON))</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            single(.success(result))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        task.resume()</span><br><span class="line"></span><br><span class="line">        return Disposables.create &#123; task.cancel() &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getRepo(&quot;ReactiveX/RxSwift&quot;)</span><br><span class="line">    .subscribe(onSuccess: &#123; json in</span><br><span class="line">        print(&quot;JSON: &quot;, json)</span><br><span class="line">    &#125;, onError: &#123; error in</span><br><span class="line">        print(&quot;Error: &quot;, error)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<h4 id="Completable"><a href="#Completable" class="headerlink" title="Completable"></a>Completable</h4><p>Completable æ˜¯ Observable çš„å¦å¤–ä¸€ä¸ªç‰ˆæœ¬ã€‚ä¸åƒ Observable å¯ä»¥å‘å‡ºå¤šä¸ªå…ƒç´ ï¼Œå®ƒè¦ä¹ˆåªèƒ½äº§ç”Ÿä¸€ä¸ª completed äº‹ä»¶ï¼Œè¦ä¹ˆäº§ç”Ÿä¸€ä¸ª error äº‹ä»¶,ä¸å…±äº«çŠ¶æ€å˜åŒ–.</p>
<p>Completable é€‚ç”¨äºé‚£ç§ä½ åªå…³å¿ƒä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œè€Œä¸éœ€è¦åœ¨æ„ä»»åŠ¡è¿”å›å€¼çš„æƒ…å†µã€‚å®ƒå’Œ Observable<void> æœ‰ç‚¹ç›¸ä¼¼ã€‚</void></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">func cacheLocally() -&gt; Completable &#123;</span><br><span class="line">    return Completable.create &#123; completable in</span><br><span class="line">       // Store some data locally</span><br><span class="line">       ...</span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       guard success else &#123;</span><br><span class="line">           completable(.error(CacheError.failedCaching))</span><br><span class="line">           return Disposables.create &#123;&#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       completable(.completed)</span><br><span class="line">       return Disposables.create &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cacheLocally()</span><br><span class="line">    .subscribe(onCompleted: &#123;</span><br><span class="line">        print(&quot;Completed with no error&quot;)</span><br><span class="line">    &#125;, onError: &#123; error in</span><br><span class="line">        print(&quot;Completed with an error: \(error.localizedDescription)&quot;)</span><br><span class="line">     &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<h4 id="Maybe"><a href="#Maybe" class="headerlink" title="Maybe"></a>Maybe</h4><p>Maybe æ˜¯ Observable çš„å¦å¤–ä¸€ä¸ªç‰ˆæœ¬ã€‚å®ƒä»‹äº Single å’Œ Completable ä¹‹é—´ï¼Œå®ƒè¦ä¹ˆåªèƒ½å‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œè¦ä¹ˆäº§ç”Ÿä¸€ä¸ª completed äº‹ä»¶ï¼Œè¦ä¹ˆäº§ç”Ÿä¸€ä¸ª error äº‹ä»¶,ä¸å…±äº«çŠ¶æ€å˜åŒ–.å¯ä»¥å¯¹ Observable è°ƒç”¨ .asMaybe() æ–¹æ³•ï¼Œå°†å®ƒè½¬æ¢ä¸º Maybeã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">func generateString() -&gt; Maybe&lt;String&gt; &#123;</span><br><span class="line">    return Maybe&lt;String&gt;.create &#123; maybe in</span><br><span class="line">        maybe(.success(&quot;RxSwift&quot;))</span><br><span class="line"></span><br><span class="line">        // OR</span><br><span class="line"></span><br><span class="line">        maybe(.completed)</span><br><span class="line"></span><br><span class="line">        // OR</span><br><span class="line"></span><br><span class="line">        maybe(.error(error))</span><br><span class="line"></span><br><span class="line">        return Disposables.create &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generateString()</span><br><span class="line">    .subscribe(onSuccess: &#123; element in</span><br><span class="line">        print(&quot;Completed with element \(element)&quot;)</span><br><span class="line">    &#125;, onError: &#123; error in</span><br><span class="line">        print(&quot;Completed with an error \(error.localizedDescription)&quot;)</span><br><span class="line">    &#125;, onCompleted: &#123;</span><br><span class="line">        print(&quot;Completed with no element&quot;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<h4 id="Driver"><a href="#Driver" class="headerlink" title="Driver"></a>Driver</h4><p>å®ƒä¸»è¦æ˜¯ä¸ºäº†ç®€åŒ– UI å±‚çš„ä»£ç .ä¸ä¼šäº§ç”Ÿ error äº‹ä»¶,ä¸€å®šåœ¨ MainScheduler ç›‘å¬ï¼ˆä¸»çº¿ç¨‹ç›‘å¬ï¼‰,å…±äº«çŠ¶æ€å˜åŒ–.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">let results = query.rx.text</span><br><span class="line">    .throttle(0.3, scheduler: MainScheduler.instance)</span><br><span class="line">    .flatMapLatest &#123; query in</span><br><span class="line">        fetchAutoCompleteItems(query)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">results</span><br><span class="line">    .map &#123; &quot;\($0.count)&quot; &#125;</span><br><span class="line">    .bind(to: resultCount.rx.text)</span><br><span class="line">    .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">results</span><br><span class="line">    .bind(to: resultsTableView.rx.items(cellIdentifier: &quot;Cell&quot;)) &#123;</span><br><span class="line">      (_, result, cell) in</span><br><span class="line">        cell.textLabel?.text = &quot;\(result)&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç çš„ä¸»è¦ç›®çš„æ˜¯ï¼š</p>
<ul>
<li>å–å‡ºç”¨æˆ·è¾“å…¥ç¨³å®šåçš„å†…å®¹</li>
<li>å‘æœåŠ¡å™¨è¯·æ±‚ä¸€ç»„ç»“æœ</li>
<li>å°†è¿”å›çš„ç»“æœç»‘å®šåˆ°ä¸¤ä¸ª UI å…ƒç´ ä¸Šï¼štableView å’Œ æ˜¾ç¤ºç»“æœæ•°é‡çš„label</li>
</ul>
<p>é‚£ä¹ˆè¿™é‡Œå­˜åœ¨ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
<ul>
<li>å¦‚æœ fetchAutoCompleteItems çš„åºåˆ—äº§ç”Ÿäº†ä¸€ä¸ªé”™è¯¯ï¼ˆç½‘ç»œè¯·æ±‚å¤±è´¥ï¼‰ï¼Œè¿™ä¸ªé”™è¯¯å°†å–æ¶ˆæ‰€æœ‰ç»‘å®šï¼Œå½“ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ–°çš„å…³é”®å­—æ—¶ï¼Œæ˜¯æ— æ³•å‘èµ·æ–°çš„ç½‘ç»œè¯·æ±‚ã€‚</li>
<li>å¦‚æœ fetchAutoCompleteItems åœ¨åå°è¿”å›åºåˆ—ï¼Œé‚£ä¹ˆåˆ·æ–°é¡µé¢ä¹Ÿä¼šåœ¨åå°è¿›è¡Œï¼Œè¿™æ ·å°±ä¼šå‡ºç°å¼‚å¸¸å´©æºƒã€‚</li>
<li>è¿”å›çš„ç»“æœè¢«ç»‘å®šåˆ°ä¸¤ä¸ª UI å…ƒç´ ä¸Šã€‚é‚£å°±æ„å‘³ç€ï¼Œæ¯æ¬¡ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ–°çš„å…³é”®å­—æ—¶ï¼Œå°±ä¼šåˆ†åˆ«ä¸ºä¸¤ä¸ª UI å…ƒç´ å‘èµ· HTTP è¯·æ±‚ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</li>
</ul>
<p>ä¸€ä¸ªæ›´å¥½çš„æ–¹æ¡ˆæ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">let results = query.rx.text</span><br><span class="line">    .throttle(0.3, scheduler: MainScheduler.instance)</span><br><span class="line">    .flatMapLatest &#123; query in</span><br><span class="line">        fetchAutoCompleteItems(query)</span><br><span class="line">            .observeOn(MainScheduler.instance)  // ç»“æœåœ¨ä¸»çº¿ç¨‹è¿”å›</span><br><span class="line">            .catchErrorJustReturn([])           // é”™è¯¯è¢«å¤„ç†äº†ï¼Œè¿™æ ·è‡³å°‘ä¸ä¼šç»ˆæ­¢æ•´ä¸ªåºåˆ—</span><br><span class="line">    &#125;</span><br><span class="line">    .share(replay: 1)                             // HTTP è¯·æ±‚æ˜¯è¢«å…±äº«çš„</span><br><span class="line"></span><br><span class="line">results</span><br><span class="line">    .map &#123; &quot;\($0.count)&quot; &#125;</span><br><span class="line">    .bind(to: resultCount.rx.text)</span><br><span class="line">    .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">results</span><br><span class="line">    .bind(to: resultsTableView.rx.items(cellIdentifier: &quot;Cell&quot;)) &#123;</span><br><span class="line">      (_, result, cell) in</span><br><span class="line">        cell.textLabel?.text = &quot;\(result)&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ Driver ä¼˜åŒ–åçš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">let results = query.rx.text.asDriver()        // å°†æ™®é€šåºåˆ—è½¬æ¢ä¸º Driver</span><br><span class="line">    .throttle(0.3, scheduler: MainScheduler.instance)</span><br><span class="line">    .flatMapLatest &#123; query in</span><br><span class="line">        fetchAutoCompleteItems(query)</span><br><span class="line">            .asDriver(onErrorJustReturn: [])  // ä»…ä»…æä¾›å‘ç”Ÿé”™è¯¯æ—¶çš„å¤‡é€‰è¿”å›å€¼</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">results</span><br><span class="line">    .map &#123; &quot;\($0.count)&quot; &#125;</span><br><span class="line">    .drive(resultCount.rx.text)               // è¿™é‡Œæ”¹ç”¨ `drive` è€Œä¸æ˜¯ `bindTo`</span><br><span class="line">    .disposed(by: disposeBag)                 // è¿™æ ·å¯ä»¥ç¡®ä¿å¿…å¤‡æ¡ä»¶éƒ½å·²ç»æ»¡è¶³äº†</span><br><span class="line"></span><br><span class="line">results</span><br><span class="line">    .drive(resultsTableView.rx.items(cellIdentifier: &quot;Cell&quot;)) &#123;</span><br><span class="line">      (_, result, cell) in</span><br><span class="line">        cell.textLabel?.text = &quot;\(result)&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>drive æ–¹æ³•åªèƒ½è¢« Driver è°ƒç”¨ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ å‘ç°ä»£ç æ‰€å­˜åœ¨ driveï¼Œé‚£ä¹ˆè¿™ä¸ªåºåˆ—ä¸ä¼šäº§ç”Ÿé”™è¯¯äº‹ä»¶å¹¶ä¸”ä¸€å®šåœ¨ä¸»çº¿ç¨‹ç›‘å¬ã€‚è¿™æ ·ä½ å¯ä»¥å®‰å…¨çš„ç»‘å®š UI å…ƒç´ ã€‚</p>
<h1 id="Observer-è§‚å¯Ÿè€…"><a href="#Observer-è§‚å¯Ÿè€…" class="headerlink" title="Observer - è§‚å¯Ÿè€…"></a>Observer - è§‚å¯Ÿè€…</h1><p>è§‚å¯Ÿè€…éœ€è¦å»è®¢é˜…(subscribe)è¢«è§‚å¯Ÿè€…(Observable)ï¼Œæ‰èƒ½æ”¶åˆ°Observableçš„äº‹ä»¶é€šçŸ¥æ¶ˆæ¯.è€Œè§‚å¯Ÿè€…å°±æ˜¯ç”±åé¢çš„ onNextï¼ŒonErrorï¼ŒonCompletedçš„è¿™äº›é—­åŒ…æ„å»ºå‡ºæ¥çš„.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">numbers</span><br><span class="line">    .subscribe(onNext: &#123; num in</span><br><span class="line">        print(&quot;å–å¾— num æˆåŠŸ: \(num)&quot;)</span><br><span class="line">    &#125;, onError: &#123; error in</span><br><span class="line">        print(&quot;å–å¾— num å¤±è´¥ Error: \(error.localizedDescription)&quot;)</span><br><span class="line">    &#125;, onCompleted: &#123;</span><br><span class="line">        print(&quot;å–å¾— num ä»»åŠ¡æˆåŠŸå®Œæˆ&quot;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<h2 id="ç‰¹å¾è§‚å¯Ÿè€…"><a href="#ç‰¹å¾è§‚å¯Ÿè€…" class="headerlink" title="ç‰¹å¾è§‚å¯Ÿè€…"></a>ç‰¹å¾è§‚å¯Ÿè€…</h2><h3 id="AnyObserver"><a href="#AnyObserver" class="headerlink" title="AnyObserver"></a>AnyObserver</h3><p>AnyObserver å¯ä»¥ç”¨æ¥æå™ä»»æ„ä¸€ç§è§‚å¯Ÿè€…ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let observer: AnyObserver&lt;Data&gt; = AnyObserver &#123; (event) in</span><br><span class="line">    switch event &#123;</span><br><span class="line">    case .next(let data):</span><br><span class="line">        print(&quot;Data Task Success with count: \(data.count)&quot;)</span><br><span class="line">    case .error(let error):</span><br><span class="line">        print(&quot;Data Task Error: \(error)&quot;)</span><br><span class="line">    default:</span><br><span class="line">        break</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">URLSession.shared.rx.data(request: URLRequest(url: url))</span><br><span class="line">    .subscribe(observer)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<h3 id="Binder"><a href="#Binder" class="headerlink" title="Binder"></a>Binder</h3><p>ä¸ä¼šå¤„ç†é”™è¯¯äº‹ä»¶,ç¡®ä¿ç»‘å®šéƒ½æ˜¯åœ¨ç»™å®š Scheduler ä¸Šæ‰§è¡Œï¼ˆé»˜è®¤ MainSchedulerï¼‰.ä¸€æ—¦äº§ç”Ÿé”™è¯¯äº‹ä»¶ï¼Œåœ¨è°ƒè¯•ç¯å¢ƒä¸‹å°†æ‰§è¡Œ fatalErrorï¼Œåœ¨å‘å¸ƒç¯å¢ƒä¸‹å°†æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">let observer: AnyObserver&lt;Bool&gt; = AnyObserver &#123; [weak self] (event) in</span><br><span class="line">    switch event &#123;</span><br><span class="line">    case .next(let isHidden):</span><br><span class="line">        self?.usernameValidOutlet.isHidden = isHidden</span><br><span class="line">    default:</span><br><span class="line">        break</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">usernameValid</span><br><span class="line">    .bind(to: observer)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>ç”±äºè¿™ä¸ªè§‚å¯Ÿè€…æ˜¯ä¸€ä¸ª UI è§‚å¯Ÿè€…ï¼Œæ‰€ä»¥å®ƒåœ¨å“åº”äº‹ä»¶æ—¶ï¼Œåªä¼šå¤„ç† next äº‹ä»¶ï¼Œå¹¶ä¸”æ›´æ–° UI çš„æ“ä½œéœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œ.å› æ­¤ä¸€ä¸ªæ›´å¥½çš„æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ Binderï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let observer: Binder&lt;Bool&gt; = Binder(usernameValidOutlet) &#123; (view, isHidden) in</span><br><span class="line">    view.isHidden = isHidden</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">usernameValid</span><br><span class="line">    .bind(to: observer)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>Binder å¯ä»¥åªå¤„ç† next äº‹ä»¶ï¼Œå¹¶ä¸”ä¿è¯å“åº” next äº‹ä»¶çš„ä»£ç ä¸€å®šä¼šåœ¨ç»™å®š Scheduler ä¸Šæ‰§è¡Œï¼Œè¿™é‡Œé‡‡ç”¨é»˜è®¤çš„ MainSchedulerã€‚</p>
<h1 id="å¯è¢«ç›‘å¬çš„åºåˆ—ä¹Ÿæ˜¯è§‚å¯Ÿè€…"><a href="#å¯è¢«ç›‘å¬çš„åºåˆ—ä¹Ÿæ˜¯è§‚å¯Ÿè€…" class="headerlink" title="å¯è¢«ç›‘å¬çš„åºåˆ—ä¹Ÿæ˜¯è§‚å¯Ÿè€…"></a>å¯è¢«ç›‘å¬çš„åºåˆ—ä¹Ÿæ˜¯è§‚å¯Ÿè€…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// ä½œä¸ºå¯è¢«ç›‘å¬çš„åºåˆ—</span><br><span class="line">let observable = textField.rx.text</span><br><span class="line">observable.subscribe(onNext: &#123; text in show(text: text) &#125;)</span><br><span class="line">// ä½œä¸ºè§‚å¯Ÿè€…</span><br><span class="line">let observer = textField.rx.text</span><br><span class="line">let text: Observable&lt;String?&gt; = ...</span><br><span class="line">text.bind(to: observer)</span><br></pre></td></tr></table></figure>
<p>æœ‰è®¸å¤š UI æ§ä»¶éƒ½å­˜åœ¨è¿™ç§ç‰¹æ€§ï¼Œä¾‹å¦‚ï¼šswitchçš„å¼€å…³çŠ¶æ€ï¼ŒsegmentedControlçš„é€‰ä¸­ç´¢å¼•å·ï¼ŒdatePickerçš„é€‰ä¸­æ—¥æœŸç­‰ç­‰ã€‚</p>
<h2 id="AsyncSubject"><a href="#AsyncSubject" class="headerlink" title="AsyncSubject"></a>AsyncSubject</h2><p>AsyncSubject å°†åœ¨æº Observable äº§ç”Ÿå®Œæˆäº‹ä»¶åï¼Œå‘å‡ºæœ€åä¸€ä¸ªå…ƒç´ ï¼ˆä»…ä»…åªæœ‰æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¦‚æœæº Observable æ²¡æœ‰å‘å‡ºä»»ä½•å…ƒç´ ï¼Œåªæœ‰ä¸€ä¸ªå®Œæˆäº‹ä»¶ã€‚é‚£ AsyncSubject ä¹Ÿåªæœ‰ä¸€ä¸ªå®Œæˆäº‹ä»¶ã€‚å®ƒä¼šå¯¹éšåçš„è§‚å¯Ÿè€…å‘å‡ºæœ€ç»ˆå…ƒç´ ã€‚å¦‚æœæº Observable å› ä¸ºäº§ç”Ÿäº†ä¸€ä¸ª error äº‹ä»¶è€Œä¸­æ­¢ï¼Œ AsyncSubject å°±ä¸ä¼šå‘å‡ºä»»ä½•å…ƒç´ ï¼Œè€Œæ˜¯å°†è¿™ä¸ª error äº‹ä»¶å‘é€å‡ºæ¥ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">let disposeBag = DisposeBag()</span><br><span class="line">let subject = AsyncSubject&lt;String&gt;()</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 1 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ¶&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ±&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ¹&quot;)</span><br><span class="line">subject.onCompleted()</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">Subscription: 1 Event: next(ğŸ¹)</span><br><span class="line">Subscription: 1 Event: completed</span><br></pre></td></tr></table></figure></p>
<h2 id="PublishSubject"><a href="#PublishSubject" class="headerlink" title="PublishSubject"></a>PublishSubject</h2><p>PublishSubject å°†å¯¹è§‚å¯Ÿè€…å‘é€è®¢é˜…åäº§ç”Ÿçš„å…ƒç´ ï¼Œè€Œåœ¨è®¢é˜…å‰å‘å‡ºçš„å…ƒç´ å°†ä¸ä¼šå‘é€ç»™è§‚å¯Ÿè€…ã€‚å¦‚æœä½ å¸Œæœ›è§‚å¯Ÿè€…æ¥æ”¶åˆ°æ‰€æœ‰çš„å…ƒç´ ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ Observable çš„ create æ–¹æ³•æ¥åˆ›å»º Observableï¼Œæˆ–è€…ä½¿ç”¨ ReplaySubjectã€‚å¦‚æœæº Observable å› ä¸ºäº§ç”Ÿäº†ä¸€ä¸ª error äº‹ä»¶è€Œä¸­æ­¢ï¼Œ PublishSubject å°±ä¸ä¼šå‘å‡ºä»»ä½•å…ƒç´ ï¼Œè€Œæ˜¯å°†è¿™ä¸ª error äº‹ä»¶å‘é€å‡ºæ¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">let disposeBag = DisposeBag()</span><br><span class="line">let subject = PublishSubject&lt;String&gt;()</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 1 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ¶&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ±&quot;)</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 2 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ…°ï¸&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ…±ï¸&quot;)</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">Subscription: 1 Event: next(ğŸ¶)</span><br><span class="line">Subscription: 1 Event: next(ğŸ±)</span><br><span class="line">Subscription: 1 Event: next(ğŸ…°ï¸)</span><br><span class="line">Subscription: 2 Event: next(ğŸ…°ï¸)</span><br><span class="line">Subscription: 1 Event: next(ğŸ…±ï¸)</span><br><span class="line">Subscription: 2 Event: next(ğŸ…±ï¸)</span><br></pre></td></tr></table></figure>
<h2 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a>ReplaySubject</h2><p>ReplaySubject å°†å¯¹è§‚å¯Ÿè€…å‘é€å…¨éƒ¨çš„å…ƒç´ ï¼Œæ— è®ºè§‚å¯Ÿè€…æ˜¯ä½•æ—¶è¿›è¡Œè®¢é˜…çš„ã€‚è¿™é‡Œå­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„ ReplaySubjectï¼Œæœ‰çš„åªä¼šå°†æœ€æ–°çš„ n ä¸ªå…ƒç´ å‘é€ç»™è§‚å¯Ÿè€…ï¼Œæœ‰çš„åªä¼šå°†é™åˆ¶æ—¶é—´æ®µå†…æœ€æ–°çš„å…ƒç´ å‘é€ç»™è§‚å¯Ÿè€…ã€‚å¦‚æœæŠŠ ReplaySubject å½“ä½œè§‚å¯Ÿè€…æ¥ä½¿ç”¨ï¼Œæ³¨æ„ä¸è¦åœ¨å¤šä¸ªçº¿ç¨‹è°ƒç”¨ onNext, onError æˆ– onCompletedã€‚è¿™æ ·ä¼šå¯¼è‡´æ— åºè°ƒç”¨ï¼Œå°†é€ æˆæ„æƒ³ä¸åˆ°çš„ç»“æœã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">let disposeBag = DisposeBag()</span><br><span class="line">let subject = ReplaySubject&lt;String&gt;.create(bufferSize: 1)</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 1 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ¶&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ±&quot;)</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 2 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ…°ï¸&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ…±ï¸&quot;)</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">Subscription: 1 Event: next(ğŸ¶)</span><br><span class="line">Subscription: 1 Event: next(ğŸ±)</span><br><span class="line">Subscription: 2 Event: next(ğŸ±)</span><br><span class="line">Subscription: 1 Event: next(ğŸ…°ï¸)</span><br><span class="line">Subscription: 2 Event: next(ğŸ…°ï¸)</span><br><span class="line">Subscription: 1 Event: next(ğŸ…±ï¸)</span><br><span class="line">Subscription: 2 Event: next(ğŸ…±ï¸)</span><br></pre></td></tr></table></figure>
<h2 id="BehaviorSubject"><a href="#BehaviorSubject" class="headerlink" title="BehaviorSubject"></a>BehaviorSubject</h2><p>å½“è§‚å¯Ÿè€…å¯¹ BehaviorSubject è¿›è¡Œè®¢é˜…æ—¶ï¼Œå®ƒä¼šå°†æº Observable ä¸­æœ€æ–°çš„å…ƒç´ å‘é€å‡ºæ¥ï¼ˆå¦‚æœä¸å­˜åœ¨æœ€æ–°çš„å…ƒç´ ï¼Œå°±å‘å‡ºé»˜è®¤å…ƒç´ ï¼‰ã€‚ç„¶åå°†éšåäº§ç”Ÿçš„å…ƒç´ å‘é€å‡ºæ¥ã€‚å¦‚æœæº Observable å› ä¸ºäº§ç”Ÿäº†ä¸€ä¸ª error äº‹ä»¶è€Œä¸­æ­¢ï¼Œ BehaviorSubject å°±ä¸ä¼šå‘å‡ºä»»ä½•å…ƒç´ ï¼Œè€Œæ˜¯å°†è¿™ä¸ª error äº‹ä»¶å‘é€å‡ºæ¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">let disposeBag = DisposeBag()</span><br><span class="line">let subject = BehaviorSubject(value: &quot;ğŸ”´&quot;)</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 1 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ¶&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ±&quot;)</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 2 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ…°ï¸&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸ…±ï¸&quot;)</span><br><span class="line"></span><br><span class="line">subject</span><br><span class="line">  .subscribe &#123; print(&quot;Subscription: 3 Event:&quot;, $0) &#125;</span><br><span class="line">  .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">subject.onNext(&quot;ğŸ&quot;)</span><br><span class="line">subject.onNext(&quot;ğŸŠ&quot;)</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">Subscription: 1 Event: next(ğŸ”´)</span><br><span class="line">Subscription: 1 Event: next(ğŸ¶)</span><br><span class="line">Subscription: 1 Event: next(ğŸ±)</span><br><span class="line">Subscription: 2 Event: next(ğŸ±)</span><br><span class="line">Subscription: 1 Event: next(ğŸ…°ï¸)</span><br><span class="line">Subscription: 2 Event: next(ğŸ…°ï¸)</span><br><span class="line">Subscription: 1 Event: next(ğŸ…±ï¸)</span><br><span class="line">Subscription: 2 Event: next(ğŸ…±ï¸)</span><br><span class="line">Subscription: 3 Event: next(ğŸ…±ï¸)</span><br><span class="line">Subscription: 1 Event: next(ğŸ)</span><br><span class="line">Subscription: 2 Event: next(ğŸ)</span><br><span class="line">Subscription: 3 Event: next(ğŸ)</span><br><span class="line">Subscription: 1 Event: next(ğŸŠ)</span><br><span class="line">Subscription: 2 Event: next(ğŸŠ)</span><br><span class="line">Subscription: 3 Event: next(ğŸŠ)</span><br></pre></td></tr></table></figure>
<h2 id="Variable"><a href="#Variable" class="headerlink" title="Variable"></a>Variable</h2><p>åœ¨ Swift ä¸­æˆ‘ä»¬ç»å¸¸ä¼šç”¨ var å…³é”®å­—æ¥å£°æ˜å˜é‡.RxSwift æä¾›çš„ Variable å®é™…ä¸Šæ˜¯ var çš„ Rx ç‰ˆæœ¬ï¼Œä½ å¯ä»¥å°†å®ƒçœ‹ä½œæ˜¯ RxVar.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">//ä½¿ç”¨ varï¼š</span><br><span class="line">// åœ¨ ViewController ä¸­</span><br><span class="line">var model: Model? = nil &#123;</span><br><span class="line">    didSet &#123; updateUI(with: model) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">override func viewDidLoad() &#123;</span><br><span class="line">    super.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    model = getModel()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func updateUI(with model: Model?) &#123; ... &#125;</span><br><span class="line">func getModel() -&gt; Model &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">//ä½¿ç”¨ Variableï¼š</span><br><span class="line">// åœ¨ ViewController ä¸­</span><br><span class="line">let model: Variable&lt;Model?&gt; = Variable(nil)</span><br><span class="line"></span><br><span class="line">override func viewDidLoad() &#123;</span><br><span class="line">    super.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    model.asObservable()</span><br><span class="line">        .subscribe(onNext: &#123; [weak self] model in</span><br><span class="line">            self?.updateUI(with: model)</span><br><span class="line">        &#125;)</span><br><span class="line">        .disposed(by: disposeBag)</span><br><span class="line"></span><br><span class="line">    model.value = getModel()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func updateUI(with model: Model?) &#123; ... &#125;</span><br><span class="line">func getModel() -&gt; Model &#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ç§ä½¿ç”¨ var çš„æ–¹å¼ååˆ†å¸¸è§ï¼Œåœ¨ ViewController ä¸­ç›‘å¬ Model çš„å˜åŒ–ï¼Œç„¶ååˆ·æ–°é¡µé¢ã€‚</p>
<p>ç¬¬äºŒç§ä½¿ç”¨ Variable åˆ™æ˜¯ RxSwift ç‹¬æœ‰çš„ã€‚Variable å‡ ä¹æä¾›äº† var çš„æ‰€æœ‰åŠŸèƒ½ã€‚å¦å¤–ï¼ŒåŠ ä¸Šä¸€æ¡éå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œå°±æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨ asObservable() æ–¹æ³•è½¬æ¢æˆåºåˆ—ã€‚ç„¶åä½ å¯ä»¥å¯¹è¿™ä¸ªåºåˆ—åº”ç”¨æ“ä½œç¬¦ï¼Œæ¥åˆæˆå…¶ä»–çš„åºåˆ—ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬å£°æ˜çš„å˜é‡éœ€è¦æä¾› Rx æ”¯æŒï¼Œé‚£å°±é€‰ç”¨ Variable è¿™ä¸ªç±»å‹ã€‚</p>
<p>Variable å°è£…äº†ä¸€ä¸ª BehaviorSubjectï¼Œæ‰€ä»¥å®ƒä¼šæŒæœ‰å½“å‰å€¼ï¼Œå¹¶ä¸” Variable ä¼šå¯¹æ–°çš„è§‚å¯Ÿè€…å‘é€å½“å‰å€¼ã€‚å®ƒä¸ä¼šäº§ç”Ÿ error äº‹ä»¶ã€‚Variable åœ¨ deinit æ—¶ï¼Œä¼šå‘å‡ºä¸€ä¸ª completed äº‹ä»¶ã€‚</p>
<h1 id="Disposable-å¯è¢«æ¸…é™¤çš„èµ„æº"><a href="#Disposable-å¯è¢«æ¸…é™¤çš„èµ„æº" class="headerlink" title="Disposable - å¯è¢«æ¸…é™¤çš„èµ„æº"></a>Disposable - å¯è¢«æ¸…é™¤çš„èµ„æº</h1><p>é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªåºåˆ—å¦‚æœå‘å‡ºäº† error æˆ–è€… completed äº‹ä»¶ï¼Œé‚£ä¹ˆæ‰€æœ‰å†…éƒ¨èµ„æºéƒ½ä¼šè¢«é‡Šæ”¾ã€‚å¦‚æœä½ éœ€è¦æå‰é‡Šæ”¾è¿™äº›èµ„æºæˆ–å–æ¶ˆè®¢é˜…çš„è¯ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¯¹è¿”å›çš„ å¯è¢«æ¸…é™¤çš„èµ„æºï¼ˆDisposableï¼‰ è°ƒç”¨ dispose æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var disposable: Disposable?</span><br><span class="line"></span><br><span class="line">override func viewWillAppear(_ animated: Bool) &#123;</span><br><span class="line">    super.viewWillAppear(animated)</span><br><span class="line"></span><br><span class="line">    self.disposable = textField.rx.text.orEmpty</span><br><span class="line">        .subscribe(onNext: &#123; text in print(text) &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">override func viewWillDisappear(_ animated: Bool) &#123;</span><br><span class="line">    super.viewWillDisappear(animated)</span><br><span class="line"></span><br><span class="line">    self.disposable?.dispose()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨ dispose æ–¹æ³•åï¼Œè®¢é˜…å°†è¢«å–æ¶ˆï¼Œå¹¶ä¸”å†…éƒ¨èµ„æºéƒ½ä¼šè¢«é‡Šæ”¾ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ æ˜¯ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ dispose æ–¹æ³•çš„ï¼Œè¿™é‡Œåªæ˜¯åšä¸ªæ¼”ç¤ºè€Œå·²ã€‚æˆ‘ä»¬æ¨èä½¿ç”¨ æ¸…é™¤åŒ…ï¼ˆDisposeBagï¼‰ æˆ–è€… takeUntil æ“ä½œç¬¦ æ¥ç®¡ç†è®¢é˜…çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h2 id="æ¸…é™¤åŒ…ï¼ˆDisposeBagï¼‰"><a href="#æ¸…é™¤åŒ…ï¼ˆDisposeBagï¼‰" class="headerlink" title="æ¸…é™¤åŒ…ï¼ˆDisposeBagï¼‰"></a>æ¸…é™¤åŒ…ï¼ˆDisposeBagï¼‰</h2><p>å› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯ Swift ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´ä¹ æƒ¯äºä½¿ç”¨ ARC æ¥ç®¡ç†å†…å­˜ã€‚é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½ç”¨ ARC æ¥ç®¡ç†è®¢é˜…çš„ç”Ÿå‘½å‘¨æœŸäº†ã€‚ç­”æ¡ˆæ˜¯è‚¯å®šäº†ï¼Œä½ å¯ä»¥ç”¨ æ¸…é™¤åŒ…ï¼ˆDisposeBagï¼‰ æ¥å®ç°è¿™ç§è®¢é˜…ç®¡ç†æœºåˆ¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var disposeBag = DisposeBag()</span><br><span class="line"></span><br><span class="line">override func viewWillAppear(_ animated: Bool) &#123;</span><br><span class="line">    super.viewWillAppear(animated)</span><br><span class="line"></span><br><span class="line">    textField.rx.text.orEmpty</span><br><span class="line">        .subscribe(onNext: &#123; text in print(text) &#125;)</span><br><span class="line">        .disposed(by: self.disposeBag)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">override func viewWillDisappear(_ animated: Bool) &#123;</span><br><span class="line">    super.viewWillDisappear(animated)</span><br><span class="line"></span><br><span class="line">    self.disposeBag = DisposeBag()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="takeUntil"><a href="#takeUntil" class="headerlink" title="takeUntil"></a>takeUntil</h2><p>å¦å¤–ä¸€ç§å®ç°è‡ªåŠ¨å–æ¶ˆè®¢é˜…çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ takeUntil æ“ä½œç¬¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">override func viewDidLoad() &#123;</span><br><span class="line">    super.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    _ = usernameValid</span><br><span class="line">        .takeUntil(self.rx.deallocated)</span><br><span class="line">        .bind(to: passwordOutlet.rx.isEnabled)</span><br><span class="line"></span><br><span class="line">    _ = usernameValid</span><br><span class="line">        .takeUntil(self.rx.deallocated)</span><br><span class="line">        .bind(to: usernameValidOutlet.rx.isHidden)</span><br><span class="line"></span><br><span class="line">    _ = passwordValid</span><br><span class="line">        .takeUntil(self.rx.deallocated)</span><br><span class="line">        .bind(to: passwordValidOutlet.rx.isHidden)</span><br><span class="line"></span><br><span class="line">    _ = everythingValid</span><br><span class="line">        .takeUntil(self.rx.deallocated)</span><br><span class="line">        .bind(to: doSomethingOutlet.rx.isEnabled)</span><br><span class="line"></span><br><span class="line">    _ = doSomethingOutlet.rx.tap</span><br><span class="line">        .takeUntil(self.rx.deallocated)</span><br><span class="line">        .subscribe(onNext: &#123; [weak self] in self?.showAlert() &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å°†ä½¿å¾—è®¢é˜…ä¸€ç›´æŒç»­åˆ°æ§åˆ¶å™¨çš„ dealloc äº‹ä»¶äº§ç”Ÿä¸ºæ­¢ã€‚</p>
<h1 id="Schedulers-è°ƒåº¦å™¨"><a href="#Schedulers-è°ƒåº¦å™¨" class="headerlink" title="Schedulers - è°ƒåº¦å™¨"></a>Schedulers - è°ƒåº¦å™¨</h1><p>Schedulers æ˜¯ Rx å®ç°å¤šçº¿ç¨‹çš„æ ¸å¿ƒæ¨¡å—ï¼Œå®ƒä¸»è¦ç”¨äºæ§åˆ¶ä»»åŠ¡åœ¨å“ªä¸ªçº¿ç¨‹æˆ–é˜Ÿåˆ—è¿è¡Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// åå°å–å¾—æ•°æ®ï¼Œä¸»çº¿ç¨‹å¤„ç†ç»“æœ</span><br><span class="line">DispatchQueue.global(qos: .userInitiated).async &#123;</span><br><span class="line">    let data = try? Data(contentsOf: url)</span><br><span class="line">    DispatchQueue.main.async &#123;</span><br><span class="line">        self.data = data</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let rxData: Observable&lt;Data&gt; = ...</span><br><span class="line"></span><br><span class="line">rxData</span><br><span class="line">    .subscribeOn(ConcurrentDispatchQueueScheduler(qos: .userInitiated))</span><br><span class="line">    .observeOn(MainScheduler.instance)</span><br><span class="line">    .subscribe(onNext: &#123; [weak self] data in</span><br><span class="line">        self?.data = data</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<h2 id="subscribeOn"><a href="#subscribeOn" class="headerlink" title="subscribeOn"></a>subscribeOn</h2><p>æˆ‘ä»¬ç”¨ subscribeOn æ¥å†³å®šæ•°æ®åºåˆ—çš„æ„å»ºå‡½æ•°åœ¨å“ªä¸ª Scheduler ä¸Šè¿è¡Œã€‚ä»¥ä¸Šä¾‹å­ä¸­ï¼Œç”±äºè·å– Data éœ€è¦èŠ±å¾ˆé•¿çš„æ—¶é—´ï¼Œæ‰€ä»¥ç”¨ subscribeOn åˆ‡æ¢åˆ° åå° Scheduler æ¥è·å– Dataã€‚è¿™æ ·å¯ä»¥é¿å…ä¸»çº¿ç¨‹è¢«é˜»å¡ã€‚</p>
<h2 id="ä½¿ç”¨-observeOn"><a href="#ä½¿ç”¨-observeOn" class="headerlink" title="ä½¿ç”¨ observeOn"></a>ä½¿ç”¨ observeOn</h2><p>æˆ‘ä»¬ç”¨ observeOn æ¥å†³å®šåœ¨å“ªä¸ª Scheduler ç›‘å¬è¿™ä¸ªæ•°æ®åºåˆ—ã€‚ä»¥ä¸Šä¾‹å­ä¸­ï¼Œé€šè¿‡ä½¿ç”¨ observeOn æ–¹æ³•åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ¥ç›‘å¬å¹¶ä¸”å¤„ç†ç»“æœã€‚</p>
<p>ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„ä¾‹å­å°±æ˜¯ï¼Œåœ¨åå°å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œç„¶åè§£ææ•°æ®ï¼Œæœ€ååœ¨ä¸»çº¿ç¨‹åˆ·æ–°é¡µé¢ã€‚ä½ å°±å¯ä»¥å…ˆç”¨ subscribeOn åˆ‡åˆ°åå°å»å‘é€è¯·æ±‚å¹¶è§£ææ•°æ®ï¼Œæœ€åç”¨ observeOn åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ›´æ–°é¡µé¢ã€‚</p>
<ul>
<li>MainSchedulerï¼šMainScheduler ä»£è¡¨ä¸»çº¿ç¨‹ã€‚å¦‚æœä½ éœ€è¦æ‰§è¡Œä¸€äº›å’Œ UI ç›¸å…³çš„ä»»åŠ¡ï¼Œå°±éœ€è¦åˆ‡æ¢åˆ°è¯¥ Scheduler è¿è¡Œã€‚</li>
<li>SerialDispatchQueueSchedulerï¼šSerialDispatchQueueScheduler æŠ½è±¡äº†ä¸²è¡Œ DispatchQueueã€‚å¦‚æœä½ éœ€è¦æ‰§è¡Œä¸€äº›ä¸²è¡Œä»»åŠ¡ï¼Œå¯ä»¥åˆ‡æ¢åˆ°è¿™ä¸ª Scheduler è¿è¡Œã€‚</li>
<li>ConcurrentDispatchQueueSchedulerï¼šConcurrentDispatchQueueScheduler æŠ½è±¡äº†å¹¶è¡Œ DispatchQueueã€‚å¦‚æœä½ éœ€è¦æ‰§è¡Œä¸€äº›å¹¶å‘ä»»åŠ¡ï¼Œå¯ä»¥åˆ‡æ¢åˆ°è¿™ä¸ª Scheduler è¿è¡Œã€‚</li>
<li>OperationQueueSchedulerï¼šOperationQueueScheduler æŠ½è±¡äº† NSOperationQueueã€‚å®ƒå…·å¤‡ NSOperationQueue çš„ä¸€äº›ç‰¹ç‚¹ï¼Œä¾‹å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½® maxConcurrentOperationCountï¼Œæ¥æ§åˆ¶åŒæ—¶æ‰§è¡Œå¹¶å‘ä»»åŠ¡çš„æœ€å¤§æ•°é‡ã€‚</li>
</ul>
<h1 id="Error-Handling-é”™è¯¯å¤„ç†"><a href="#Error-Handling-é”™è¯¯å¤„ç†" class="headerlink" title="Error Handling - é”™è¯¯å¤„ç†"></a>Error Handling - é”™è¯¯å¤„ç†</h1><p>ä¸€æ—¦åºåˆ—é‡Œé¢äº§å‡ºäº†ä¸€ä¸ª error äº‹ä»¶ï¼Œæ•´ä¸ªåºåˆ—å°†è¢«ç»ˆæ­¢ã€‚RxSwift ä¸»è¦æœ‰ä¸¤ç§é”™è¯¯å¤„ç†æœºåˆ¶</p>
<h2 id="retry-é‡è¯•"><a href="#retry-é‡è¯•" class="headerlink" title="retry - é‡è¯•"></a>retry - é‡è¯•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// è¯·æ±‚ JSON å¤±è´¥æ—¶ï¼Œç«‹å³é‡è¯•ï¼Œ</span><br><span class="line">// é‡è¯• 3 æ¬¡åä»ç„¶å¤±è´¥ï¼Œå°±å°†é”™è¯¯æŠ›å‡º</span><br><span class="line"></span><br><span class="line">let rxJson: Observable&lt;JSON&gt; = ...</span><br><span class="line"></span><br><span class="line">rxJson</span><br><span class="line">    .retry(3)</span><br><span class="line">    .subscribe(onNext: &#123; json in</span><br><span class="line">        print(&quot;å–å¾— JSON æˆåŠŸ: \(json)&quot;)</span><br><span class="line">    &#125;, onError: &#123; error in</span><br><span class="line">        print(&quot;å–å¾— JSON å¤±è´¥: \(error)&quot;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨å‘ç”Ÿé”™è¯¯æ—¶ï¼Œç»è¿‡ä¸€æ®µå»¶æ—¶åé‡è¯•ï¼Œé‚£å¯ä»¥ç”¨retryWhenï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// è¯·æ±‚ JSON å¤±è´¥æ—¶ï¼Œç­‰å¾… 5 ç§’åé‡è¯•ï¼Œ</span><br><span class="line">// é‡è¯• 4 æ¬¡åä»ç„¶å¤±è´¥ï¼Œå°±å°†é”™è¯¯æŠ›å‡º</span><br><span class="line"></span><br><span class="line">let maxRetryCount = 4       // æœ€å¤šé‡è¯• 4 æ¬¡</span><br><span class="line">let retryDelay: Double = 5  // é‡è¯•å»¶æ—¶ 5 ç§’</span><br><span class="line"></span><br><span class="line">rxJson</span><br><span class="line">    .retryWhen &#123; (rxError: Observable&lt;Error&gt;) -&gt; Observable&lt;Int&gt; in</span><br><span class="line">        return rxError.flatMapWithIndex &#123; (error, index) -&gt; Observable&lt;Int&gt; in</span><br><span class="line">            guard index &lt; maxRetryCount else &#123;</span><br><span class="line">                return Observable.error(error)</span><br><span class="line">            &#125;</span><br><span class="line">            return Observable&lt;Int&gt;.timer(retryDelay, scheduler: MainScheduler.instance)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .subscribe(...)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿™é‡Œè¦å®ç°çš„æ˜¯ï¼Œå¦‚æœé‡è¯•è¶…è¿‡ 4 æ¬¡ï¼Œå°±å°†é”™è¯¯æŠ›å‡ºã€‚å¦‚æœé”™è¯¯åœ¨ 4 æ¬¡ä»¥å†…æ—¶ï¼Œå°±ç­‰å¾… 5 ç§’åé‡è¯•ï¼Œæˆ‘ä»¬ç”¨ flatMapWithIndex è¿™ä¸ªæ“ä½œç¬¦ï¼Œå› ä¸ºå®ƒå¯ä»¥ç»™æˆ‘ä»¬æä¾›é”™è¯¯çš„ç´¢å¼•æ•° indexã€‚ç„¶åç”¨è¿™ä¸ªç´¢å¼•æ•°åˆ¤æ–­æ˜¯å¦è¶…è¿‡æœ€å¤§é‡è¯•æ•°ï¼Œå¦‚æœè¶…è¿‡äº†ï¼Œå°±å°†é”™è¯¯æŠ›å‡ºã€‚å¦‚æœæ²¡æœ‰è¶…è¿‡ï¼Œå°±ç­‰å¾… 5 ç§’åé‡è¯•ã€‚</p>
<h2 id="catchError-æ¢å¤"><a href="#catchError-æ¢å¤" class="headerlink" title="catchError - æ¢å¤"></a>catchError - æ¢å¤</h2><p>catchError å¯ä»¥åœ¨é”™è¯¯äº§ç”Ÿæ—¶ï¼Œç”¨ä¸€ä¸ªå¤‡ç”¨å…ƒç´ æˆ–è€…ä¸€ç»„å¤‡ç”¨å…ƒç´ å°†é”™è¯¯æ›¿æ¢æ‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">searchBar.rx.text.orEmpty</span><br><span class="line">    ...</span><br><span class="line">    .flatMapLatest &#123; query -&gt; Observable&lt;[Repository]&gt; in</span><br><span class="line">        ...</span><br><span class="line">        return searchGitHub(query)</span><br><span class="line">            .catchErrorJustReturn([])</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    .bind(to: ...)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// å½“ç”¨æˆ·ç‚¹å‡»æ›´æ–°æŒ‰é’®æ—¶ï¼Œ</span><br><span class="line">// å°±ç«‹å³å–å‡ºä¿®æ”¹åçš„ç”¨æˆ·ä¿¡æ¯ã€‚</span><br><span class="line">// ç„¶åå‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œè¿›è¡Œæ›´æ–°æ“ä½œï¼Œ</span><br><span class="line">// ä¸€æ—¦æ“ä½œå¤±è´¥å°±æç¤ºç”¨æˆ·å¤±è´¥åŸå› </span><br><span class="line"></span><br><span class="line">updateUserInfoButton.rx.tap</span><br><span class="line">    .withLatestFrom(rxUserInfo)</span><br><span class="line">    .flatMapLatest &#123; userInfo -&gt; Observable&lt;Void&gt; in</span><br><span class="line">        return update(userInfo)</span><br><span class="line">    &#125;</span><br><span class="line">    .observeOn(MainScheduler.instance)</span><br><span class="line">    .subscribe(onNext: &#123;</span><br><span class="line">        print(&quot;ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸ&quot;)</span><br><span class="line">    &#125;, onError: &#123; error in</span><br><span class="line">        print(&quot;ç”¨æˆ·ä¿¡æ¯æ›´æ–°å¤±è´¥ï¼š \(error.localizedDescription)&quot;)</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å®ç°æ˜¯éå¸¸ç›´æ¥çš„ã€‚ä½†æ˜¯ä¸€æ—¦ç½‘ç»œè¯·æ±‚æ“ä½œå¤±è´¥äº†ï¼Œåºåˆ—å°±ä¼šç»ˆæ­¢ã€‚æ•´ä¸ªè®¢é˜…å°†è¢«å–æ¶ˆã€‚å¦‚æœç”¨æˆ·å†æ¬¡ç‚¹å‡»æ›´æ–°æŒ‰é’®ï¼Œå°±æ— æ³•å†æ¬¡å‘èµ·ç½‘ç»œè¯·æ±‚è¿›è¡Œæ›´æ–°æ“ä½œäº†ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆæ¥è¿›è¡Œé”™è¯¯å¤„ç†ã€‚ä¾‹å¦‚ä½¿ç”¨æšä¸¾ Resultï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// è‡ªå®šä¹‰ä¸€ä¸ªæšä¸¾ç±»å‹ Result</span><br><span class="line">public enum Result&lt;T&gt; &#123;</span><br><span class="line">    case success(T)</span><br><span class="line">    case failure(Swift.Error)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">updateUserInfoButton.rx.tap</span><br><span class="line">    .withLatestFrom(rxUserInfo)</span><br><span class="line">    .flatMapLatest &#123; userInfo -&gt; Observable&lt;Result&lt;Void&gt;&gt; in</span><br><span class="line">        return update(userInfo)</span><br><span class="line">            .map(Result.success)  // è½¬æ¢æˆ Result</span><br><span class="line">            .catchError &#123; error in Observable.just(Result.failure(error)) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .observeOn(MainScheduler.instance)</span><br><span class="line">    .subscribe(onNext: &#123; result in</span><br><span class="line">        switch result &#123;           // å¤„ç† Result</span><br><span class="line">        case .success:</span><br><span class="line">            print(&quot;ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸ&quot;)</span><br><span class="line">        case .failure(let error):</span><br><span class="line">            print(&quot;ç”¨æˆ·ä¿¡æ¯æ›´æ–°å¤±è´¥ï¼š \(error.localizedDescription)&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .disposed(by: disposeBag)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬çš„é”™è¯¯äº‹ä»¶è¢«åŒ…è£…æˆäº† Result.failure(Error) å…ƒç´ ï¼Œå°±ä¸ä¼šç»ˆæ­¢æ•´ä¸ªåºåˆ—ã€‚å°±ç®—ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œæ•´ä¸ªè®¢é˜…ä¾ç„¶å­˜åœ¨ã€‚å¦‚æœç”¨æˆ·å†æ¬¡ç‚¹å‡»æ›´æ–°æŒ‰é’®ï¼Œä¹Ÿæ˜¯èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚è¿›è¡Œæ›´æ–°æ“ä½œçš„ã€‚</p>

    </div>
</article>


<div id="comments-template"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script>
	if(!window.commentConfig) {
      window.commentConfig = {}
      window.commentConfig.title = 'Fri Oct 20 2017 20:10:09 GMT+0800'
    }
</script>

                </div>
                <aside class="col-md-4 gal-left" id="sidebar">
    <!-- æ­¤ä¸ºsidebarçš„æœç´¢æ¡†, éæœç´¢ç»“æœé¡µé¢ -->
<aside id="sidebar-search">
    <div class="search hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <form class="form-inline clearfix" id="search-form" method="get"
              action="/search/index.html">
            <input type="text" name="s" class="form-control" id="searchInput" placeholder="æœç´¢æ–‡ç« ~">
            <button class="btn btn-danger btn-gal" type="submit">
                <i class="fa fa-search"></i>
            </button>
        </form>
    </div>
</aside>
    <aside id="sidebar-author">
    <div class="panel panel-gal" data-aos="flip-right" data-aos-duration="3000">
        <div class="panel-heading" style="text-align: center">
            <i class="fa fa-quote-left"></i>
            Levin Luo
            <i class="fa fa-quote-right"></i>
        </div>
        <div class="author-panel text-center">
            <img src="/imgs/avatar.jpg" width="140" height="140"
                 alt="ä¸ªäººå¤´åƒ" class="author-image">
            <p class="author-description"><p>Stay hungryã€stay foolish.</p>
</p>
        </div>
    </div>
</aside>
    
    <!-- è¦é…ç½®å¥½leancloudæ‰èƒ½å¼€å¯æ­¤å°å·¥å…· -->
    
    
    <aside id="sidebar-recent_posts">
    <div class="panel panel-gal recent hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-refresh"></i>
            è¿‘æœŸæ–‡ç« 
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush">
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2018/03/23/å¿«é€Ÿå®šä½ç›®æ ‡æ§åˆ¶å™¨/">å¿«é€Ÿå®šä½ç›®æ ‡æ§åˆ¶å™¨</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2018/03/20/éè‘—åä¸ä¸“ä¸šç¨‹åºå‘˜å¿…å¤‡å·¥å…·/">éè‘—åä¸ä¸“ä¸šç¨‹åºå‘˜å¿…å¤‡å·¥å…·</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2018/03/18/iOSä¼˜è´¨åšå®¢/">iOSä¼˜è´¨åšå®¢</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2017/11/07/RxSwiftæ“ä½œç¬¦é€‰æ‹©/">RxSwiftæ“ä½œç¬¦é€‰æ‹©</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2017/11/03/RxSwiftæ“ä½œç¬¦/">RxSwiftæ“ä½œç¬¦</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2017/10/20/RxSwiftæ ¸å¿ƒæ¦‚å¿µ/">RxSwiftæ ¸å¿ƒæ¦‚å¿µ</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2017/10/14/iOSç»„ä»¶åŒ–/">è·¯ç”±åè®®</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2017/09/26/å¤šçº¿ç¨‹ä½¿ç”¨/">å¤šçº¿ç¨‹ä½¿ç”¨</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2017/09/15/å¤šçº¿ç¨‹/">å¤šçº¿ç¨‹</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2017/08/11/runloopå®è·µ/">runloopå®è·µ</a>
                </span>
            </li>
            
        </ul>
    </div>
</aside>
    
    
    
    <aside id="gal-sets">
        <div class="panel panel-gal hidden-xs" data-aos="fade-up" data-aos-duration="2000">
            <ul class="nav nav-pills pills-gal">
                <li class="">
                    <a href="/2017/10/20/RxSwiftæ ¸å¿ƒæ¦‚å¿µ/index.html#sidebar-tags" data-toggle="tab" id="tags-tab">çƒ­é—¨æ ‡ç­¾</a>
                </li>
                <li class="">
                    <a href="/2017/10/20/RxSwiftæ ¸å¿ƒæ¦‚å¿µ/index.html#sidebar-friend-links" data-toggle="tab" id="friend-links-tab">å‹æƒ…é“¾æ¥</a>
                </li>
                <li class="">
                    <a href="/2017/10/20/RxSwiftæ ¸å¿ƒæ¦‚å¿µ/index.html#sidebar-links" data-toggle="tab" id="links-tab">ä¸ªäººé“¾æ¥</a>
                </li>
            </ul>
            <div class="tab-content">
                <div class="cloud-tags tab-pane nav bs-sidenav fade" id="sidebar-tags">
    
    <a href="/tags/RxSWift/" style="font-size: 14.98792960847205px;" class="tag-cloud-link">RxSWift</a>
    
    <a href="/tags/RxSwift/" style="font-size: 10.366830304101203px;" class="tag-cloud-link">RxSwift</a>
    
    <a href="/tags/UIç¯‡/" style="font-size: 12.595355391806006px;" class="tag-cloud-link">UIç¯‡</a>
    
    <a href="/tags/Tip/" style="font-size: 8.831470335768223px;" class="tag-cloud-link">Tip</a>
    
    <a href="/tags/iOSä¼˜è´¨åšå®¢/" style="font-size: 15.620082077924982px;" class="tag-cloud-link">iOSä¼˜è´¨åšå®¢</a>
    
    <a href="/tags/runloop/" style="font-size: 17.214127279817518px;" class="tag-cloud-link">runloop</a>
    
    <a href="/tags/runtime/" style="font-size: 18.388917561960007px;" class="tag-cloud-link">runtime</a>
    
    <a href="/tags/çº¿ç¨‹/" style="font-size: 15.343800293622401px;" class="tag-cloud-link">çº¿ç¨‹</a>
    
    <a href="/tags/å·¥å…·ç¯‡/" style="font-size: 12.68572561899165px;" class="tag-cloud-link">å·¥å…·ç¯‡</a>
    
</div>
                <div class="friend-links tab-pane nav bs-sidenav fade" id="sidebar-friend-links">
    
    <li>
        <a href="http://www.levinluo.com" target="_blank">Levin Luo</a>
    </li>
    
</div>
                <div class="links tab-pane nav bs-sidenav fade" id="sidebar-links">
    
    <li>
        <a href="http://www.levinluo.com" target="_blank">Levin Luo</a>
    </li>
    
</div>
            </div>
        </div>
    </aside>
    
</aside>
            </div>
        </div>
    </div>
    <footer id="gal-footer">
    <div class="container">
        Copyright Â© 2017 Levin Luo Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></a>
    </div>
</footer>

<!-- å›åˆ°é¡¶ç«¯ -->
<div id="gal-gotop">
    <i class="fa fa-angle-up"></i>
</div>
</body>
<script src="/js/activate-power-mode.js"></script>
<script>
    // é…ç½®highslide
  hs.graphicsDir = '/js/highslide/graphics/'
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.lang.number = 'å…±%2å¼ å›¾, å½“å‰æ˜¯ç¬¬%1å¼ ';
    hs.addSlideshow({
      interval: 5000,
      repeat: true,
      useControls: true,
      fixedControls: "fit",
      overlayOptions: {
        opacity: 0.75,
        position: "bottom center",
        hideOnMouseOut: true
      }
    })
    // åˆå§‹åŒ–aos
    AOS.init({
      duration: 1000,
      delay: 0,
      easing: 'ease-out-back'
    });
</script>
<script>
  POWERMODE.colorful = 'true';    // make power mode colorful
  POWERMODE.shake = 'true';       // turn off shake
  // TODO è¿™é‡Œæ ¹æ®å…·ä½“æƒ…å†µä¿®æ”¹
  document.body.addEventListener('input', POWERMODE);
</script>
<script>
    window.slideConfig = {
      prefix: '/imgs/slide/background',
      ext: 'jpg',
      maxCount: '6'
    }
</script>
<script src="/js/hs.js"></script>
<script src="/js/blog.js"></script>



<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    if(window.commentConfig) {
      window.commentConfig.id = 'Fri Oct 20 2017 20:10:09 GMT+0800'
      window.commentConfig.owner = 'PuShengLuo'
      window.commentConfig.repo = 'PuShengLuo.github.io'
      window.commentConfig.client_id = 'cc1a44fe73dbdbe0edb7'
      window.commentConfig.client_secret = 'b101ced75c5c8a67aff6dd02e85125eb775ffd1c'
      window.commentConfig.redirect_uri = ''
    } else {
      window.commentConfig = {
        id: 'Fri Oct 20 2017 20:10:09 GMT+0800',
        owner: 'PuShengLuo',
        repo: 'PuShengLuo.github.io',
        client_id: 'cc1a44fe73dbdbe0edb7',
        client_secret: 'b101ced75c5c8a67aff6dd02e85125eb775ffd1c',
        redirect_uri: ''
      }
    }
</script>
<script src="/js/comment/gitment.js"></script>

</html>